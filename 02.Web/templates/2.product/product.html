{% extends "layout.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/2.product/product.css') }}">

<div class="product-wrapper">
    <div class="page-header">
        <h2>📦 제품 관리 시스템</h2>
        <a href="{{ url_for('product.product_registration') }}" class="btn-add">+ 새 제품 등록</a>
    </div>

    <section class="search-section">
        <form action="{{ url_for('product.list_product') }}" method="GET" class="search-form">
            <div class="search-group">
                <label>제품명 또는 ID</label>
                <input type="text" name="names" class="search-input" value="{{ request.args.get('names', '') }}" placeholder="검색어 입력...">
            </div>

            <div class="search-group">
                <label>타겟 해충</label>
                <input type="text" name="target" class="search-input" value="{{ request.args.get('target', '') }}" placeholder="해충 이름 입력...">
            </div>

            <div class="search-group">
                <label>판매 상태</label>
                <select name="status" class="search-input">
                    <option value="">-- 상태 전체 --</option>
                    {% for s in status_list %}
                        <option value="{{ s }}" {% if request.args.get('status') == s %}selected{% endif %}>
                            {{ '판매중' if s == 'AVAILABLE' else '단종' }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn-search">검색</button>
        </form>
    </section>

    <div class="product-table-container">
        <table class="product-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>제품명</th>
                    <th>타겟 해충</th>
                    <th>상태</th>
                    <th>단가 (원)</th>
                    <th>관리</th>
                </tr>
            </thead>
            <tbody>
                {% for p in products %}
                <tr>
                    <td><code>{{ p.PRODUCT_ID }}</code></td>
                    <td style="text-align: left; padding-left: 20px;">
                        <a href="{{ url_for('product.product_detail', product_id=p.PRODUCT_ID) }}" class="product-name-link">
                            <strong>{{ p.PRODUCT_NAME }}</strong>
                        </a>
                    </td>
                    <td><span class="category-badge">{{ p.TARGET or '-' }}</span></td>
                    <td>
                        <span class="status-badge {{ 'status-active' if p.STATUS == 'AVAILABLE' else 'status-discontinued' }}">
                            {{ '판매중' if p.STATUS == 'AVAILABLE' else '단종' }}
                        </span>
                    </td>
                    <td class="price-cell"><strong>{{ "{:,.0f}".format(p.PRICE_KOR) }}</strong>원</td>
                    <td>
                        <div class="action-buttons">
                            <a href="{{ url_for('product.product_detail', product_id=p.PRODUCT_ID) }}" class="btn-edit">상세</a>
                            <a href="#" class="btn-delete" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</a>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="no-data">일치하는 제품을 찾을 수 없습니다.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}