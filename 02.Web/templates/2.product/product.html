{% extends "layout.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/2.product/product.css') }}">
<div class="container mt-3">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-primary alert-dismissible fade show auto-dismiss shadow-sm" role="alert">
            <i class="bi bi-info-circle me-2"></i>
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
</div>
<div class="product-wrapper">
    <div class="page-header">
        <h2>ğŸ“¦ ì œí’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ</h2>
        <a href="{{ url_for('product.product_registration') }}" class="btn-add">+ ìƒˆ ì œí’ˆ ë“±ë¡</a>
    </div>

    <section class="search-section">
        <form action="{{ url_for('product.list_product') }}" method="GET" class="search-form">
            <div class="search-group">
                <label>ì œí’ˆëª… ë˜ëŠ” ID</label>
                <input type="text" name="names" class="search-input" value="{{ request.args.get('names', '') }}" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥...">
            </div>

            <div class="search-group">
                <label>íƒ€ê²Ÿ í•´ì¶©</label>
                <input type="text" name="target" class="search-input" value="{{ request.args.get('target', '') }}" placeholder="í•´ì¶© ì´ë¦„ ì…ë ¥...">
            </div>

            <div class="search-group">
                <label>íŒë§¤ ìƒíƒœ</label>
                <select name="status" class="search-input">
                    <option value="">-- ìƒíƒœ ì „ì²´ --</option>
                    {% for s in status_list %}
                        <option value="{{ s }}" {% if request.args.get('status') == s %}selected{% endif %}>
                            {{ 'íŒë§¤ì¤‘' if s == 'AVAILABLE' else 'ë‹¨ì¢…' }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn-search">ê²€ìƒ‰</button>
        </form>
    </section>

    <div class="product-table-container">
        <table class="product-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>ì œí’ˆëª…</th>
                    <th>íƒ€ê²Ÿ í•´ì¶©</th>
                    <th>ìƒíƒœ</th>
                    <th>ë‹¨ê°€ (ì›)</th>
                    <th>ê´€ë¦¬</th>
                </tr>
            </thead>
            <tbody>
                {% for p in products %}
                <tr>
                    <td><code>{{ p.PRODUCT_ID }}</code></td>
                    <td style="text-align: center; padding-left: 20px;">
                        <a href="{{ url_for('product.product_detail', product_id=p.PRODUCT_ID) }}" class="product-name-link">
                            <strong>{{ p.PRODUCT_NAME }}</strong>
                        </a>
                    </td>
                    <td><span class="category-badge">{{ p.TARGET or '-' }}</span></td>
                    <td>
                        <span class="status-badge {{ 'status-active' if p.STATUS == 'AVAILABLE' else 'status-discontinued' }}">
                            {{ 'íŒë§¤ì¤‘' if p.STATUS == 'AVAILABLE' else 'ë‹¨ì¢…' }}
                        </span>
                    </td>
                    <td class="price-cell"><strong>{{ "{:,.0f}".format(p.PRICE_KOR) }}</strong>ì›</td>
                    <td>
                        <div class="action-buttons">
                            <a href="{{ url_for('product.product_detail', product_id=p.PRODUCT_ID) }}" class="btn-edit">ìƒì„¸</a>
                            <a href="{{ url_for('product.delete_product', product_id=p.PRODUCT_ID) }}" class="btn-delete" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ì‚­ì œ</a>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="no-data">ì¼ì¹˜í•˜ëŠ” ì œí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}